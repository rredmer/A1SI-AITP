# ~/Dev/A1SI-AITP/configs/platform_config.yaml
# Master configuration for the A1SI-AITP platform
# All sensitive values (API keys) should be set via environment variables

platform:
  name: "a1si-aitp"
  version: "0.1.0"
  base_dir: "."
  log_level: "INFO"

# ──────────────────────────────────────────────
# Exchange connections (via CCXT)
# ──────────────────────────────────────────────
exchanges:
  binance:
    exchange_id: "binance"
    api_key_env: "BINANCE_API_KEY"
    secret_env: "BINANCE_SECRET"
    sandbox: true  # Start in testnet mode
    rate_limit: true
    options:
      defaultType: "spot"  # spot, future, margin
      adjustForTimeDifference: true

  bybit:
    exchange_id: "bybit"
    api_key_env: "BYBIT_API_KEY"
    secret_env: "BYBIT_SECRET"
    sandbox: true
    rate_limit: true
    options:
      defaultType: "spot"

  kraken:
    exchange_id: "kraken"
    api_key_env: "KRAKEN_API_KEY"
    secret_env: "KRAKEN_SECRET"
    sandbox: true
    rate_limit: true

# ──────────────────────────────────────────────
# Data pipeline configuration
# ──────────────────────────────────────────────
data:
  storage_format: "parquet"  # parquet or hdf5
  base_path: "data"
  raw_path: "data/raw"
  processed_path: "data/processed"
  orderbook_path: "data/orderbook"

  # Default pairs to track
  watchlist:
    - "BTC/USDT"
    - "ETH/USDT"
    - "SOL/USDT"
    - "BNB/USDT"
    - "XRP/USDT"
    - "ADA/USDT"
    - "AVAX/USDT"
    - "DOGE/USDT"
    - "DOT/USDT"
    - "LINK/USDT"

  timeframes:
    - "1m"
    - "5m"
    - "15m"
    - "1h"
    - "4h"
    - "1d"

  # Per-asset-class watchlists
  equity_watchlist:
    - "AAPL/USD"
    - "MSFT/USD"
    - "GOOGL/USD"
    - "AMZN/USD"
    - "NVDA/USD"
    - "SPY/USD"
    - "QQQ/USD"
    - "IWM/USD"
    - "GLD/USD"
    - "TLT/USD"

  forex_watchlist:
    - "EUR/USD"
    - "GBP/USD"
    - "USD/JPY"
    - "USD/CHF"
    - "AUD/USD"
    - "NZD/USD"
    - "USD/CAD"
    - "EUR/GBP"
    - "EUR/JPY"
    - "GBP/JPY"
    - "AUD/JPY"
    - "EUR/CHF"
    - "EUR/AUD"
    - "GBP/CHF"
    - "NZD/JPY"

  # How many days of historical data to fetch
  history_days: 365

# ──────────────────────────────────────────────
# Freqtrade configuration
# ──────────────────────────────────────────────
freqtrade:
  dry_run: true
  trading_mode: "spot"
  stake_currency: "USDT"
  stake_amount: "unlimited"
  tradable_balance_ratio: 0.99
  max_open_trades: 5

  # FreqAI configuration (Freqtrade-specific)
  freqai:
    enabled: false  # Enable after initial strategy validation
    model_type: "LightGBMClassifier"
    train_period_days: 90
    backtest_period_days: 7
    identifier: "crypto_investor_v1"
    feature_parameters:
      include_timeframes:
        - "5m"
        - "15m"
        - "1h"
      include_corr_pairlist:
        - "BTC/USDT"
        - "ETH/USDT"
      indicator_periods_candles:
        - 10
        - 20
        - 50

  # Standalone ML pipeline (common/ml/)
  ml:
    enabled: false  # Enable after validation
    model_storage_path: "models"  # Relative to project root

    # Feature engineering
    features:
      lag_periods: [1, 2, 3, 5]
      return_periods: [1, 3, 5, 10]
      target_horizon: 1  # Bars ahead for binary target

    # LightGBM training parameters
    training:
      model_type: "LightGBMClassifier"
      test_ratio: 0.2
      params:
        objective: "binary"
        metric: "binary_logloss"
        boosting_type: "gbdt"
        num_leaves: 31
        learning_rate: 0.05
        n_estimators: 200
        max_depth: 6
        min_child_samples: 20
        subsample: 0.8
        colsample_bytree: 0.8
        reg_alpha: 0.1
        reg_lambda: 0.1
        n_jobs: 4  # Adjust based on available CPU cores

  # Risk management
  risk:
    stoploss: -0.05            # -5% stop loss
    trailing_stop: true
    trailing_stop_positive: 0.01
    trailing_stop_positive_offset: 0.03
    trailing_only_offset_is_reached: true
    roi:
      "0": 0.10      # 10% ROI target
      "30": 0.05     # 5% after 30 min
      "120": 0.02    # 2% after 2 hours
      "360": 0.01    # 1% after 6 hours

# ──────────────────────────────────────────────
# NautilusTrader configuration
# ──────────────────────────────────────────────
nautilus:
  environment: "backtest"  # backtest or live
  log_level: "INFO"
  cache_database: true
  cache_type: "in-memory"  # in-memory for single-node; redis for multi-process deployments
  data_engine:
    time_bars_build_delay: true
  risk_engine:
    max_order_submit_rate: "10/00:00:01"  # 10 orders per second
    max_notional_per_order: 10000.0  # USDT

  # Backtest defaults
  backtest:
    initial_balance: 10000.0
    fee_rate: 0.001          # 0.1% taker fee
    max_bars_in_memory: 5000  # Adjust based on available RAM

  # Per-strategy parameter defaults
  strategies:
    NautilusTrendFollowing:
      ema_fast: 50
      ema_slow: 200
      buy_rsi_threshold: 40
      sell_rsi_threshold: 80
      atr_multiplier: 2.0
      stoploss: -0.05
    NautilusMeanReversion:
      buy_rsi_threshold: 35
      sell_rsi_threshold: 65
      volume_factor: 1.5
      adx_ceiling: 30
      atr_multiplier: 1.5
      stoploss: -0.04
    NautilusVolatilityBreakout:
      breakout_period: 20
      volume_factor: 1.8
      adx_low: 15
      adx_high: 25
      rsi_low: 40
      rsi_high: 70
      sell_rsi_threshold: 85
      atr_multiplier: 1.5
      stoploss: -0.03
    EquityMomentum:
      sma_slow: 200
      sma_fast: 50
      buy_rsi_low: 30
      buy_rsi_high: 50
      sell_rsi_threshold: 75
      volume_factor: 1.5
      stoploss: -0.03
    EquityMeanReversion:
      buy_rsi_threshold: 30
      sell_sma_period: 20
      volume_factor: 1.5
      stoploss: -0.04
    ForexTrend:
      ema_fast: 20
      ema_slow: 50
      adx_threshold: 25
      buy_rsi_low: 40
      buy_rsi_high: 70
      sell_rsi_threshold: 70
      stoploss: -0.02
    ForexRange:
      adx_ceiling: 20
      buy_rsi_threshold: 30
      sell_rsi_threshold: 70
      stoploss: -0.015

# ──────────────────────────────────────────────
# VectorBT research configuration
# ──────────────────────────────────────────────
vectorbt:
  default_freq: "1h"
  default_fees: 0.001  # 0.1% trading fee
  default_slippage: 0.0005  # 0.05% slippage
  num_tests: 1000  # parameter combinations per sweep
  metrics:
    - "total_return"
    - "sharpe_ratio"
    - "max_drawdown"
    - "win_rate"
    - "profit_factor"
    - "calmar_ratio"

# ──────────────────────────────────────────────
# Risk management (global)
# ──────────────────────────────────────────────
risk_management:
  max_portfolio_drawdown: 0.15  # 15% max drawdown → halt all trading
  max_single_trade_risk: 0.02   # 2% of portfolio per trade
  max_daily_loss: 0.05          # 5% daily loss limit
  max_correlation: 0.7          # Max correlation between concurrent positions
  min_paper_trade_days: 14      # Minimum paper trading before live

# ──────────────────────────────────────────────
# Per-asset-class risk overrides
# ──────────────────────────────────────────────
equity:
  risk:
    stoploss: -0.03
    max_position_size_pct: 0.05
    max_daily_loss: 0.03

forex:
  risk:
    stoploss: -0.02
    max_leverage: 1.0
    max_position_size_pct: 0.10
    max_daily_loss: 0.04

# ──────────────────────────────────────────────
# hftbacktest configuration (Tier 4 — HFT)
# ──────────────────────────────────────────────
hftbacktest:
  latency_ns: 1000000          # 1ms simulated latency
  fee_rate: 0.0002             # 0.02% maker fee (HFT typically maker)
  initial_balance: 10000.0
  ticks_per_bar: 4             # Synthetic ticks generated per OHLCV bar

  strategies:
    MarketMaker:
      half_spread: 0.001       # 10 bps half-spread
      skew_factor: 0.0005      # Inventory skew per unit
      order_size: 0.01         # Base currency units per quote
      max_position: 1.0        # Max absolute position
      drawdown_halt_pct: 0.05  # Halt at 5% drawdown
      quote_interval: 4        # Requote every N ticks

# ──────────────────────────────────────────────
# News & Sentiment
# ──────────────────────────────────────────────
news:
  # NewsAPI.org (optional, free tier = 100 req/day)
  # Set NEWSAPI_KEY env var to enable
  newsapi_enabled: false

  # RSS feeds per asset class (always active, no API key needed)
  rss_feeds:
    crypto:
      - name: "CoinDesk"
        url: "https://www.coindesk.com/arc/outboundfeeds/rss/"
      - name: "CoinTelegraph"
        url: "https://cointelegraph.com/rss"
      - name: "Decrypt"
        url: "https://decrypt.co/feed"
    equity:
      - name: "Yahoo Finance"
        url: "https://finance.yahoo.com/news/rssindex"
      - name: "MarketWatch"
        url: "https://feeds.marketwatch.com/marketwatch/topstories/"
    forex:
      - name: "DailyFX"
        url: "https://www.dailyfx.com/feeds/market-news"
      - name: "ForexFactory"
        url: "https://www.forexfactory.com/rss.php"

  # Article retention
  max_articles: 1000  # Oldest auto-deleted beyond this cap

  # Fetch interval (used by scheduler)
  fetch_interval_minutes: 30

# ──────────────────────────────────────────────
# Monitoring & alerts
# ──────────────────────────────────────────────
monitoring:
  telegram:
    enabled: false
    token_env: "TELEGRAM_BOT_TOKEN"
    chat_id_env: "TELEGRAM_CHAT_ID"

  dashboard:
    enabled: true
    port: 8501
    refresh_seconds: 30
